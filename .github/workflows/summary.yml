name: Daily Summary

on:
  workflow_dispatch:
  schedule:
    - cron: "5 22 * * *"  # 22:05 UTC → 23:05 BUD

concurrency:
  group: livemesterbot-summary
  cancel-in-progress: true

jobs:
  summary:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    env:
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}

      # Az esti összegzés a csatornára menjen (mindenki látja)
      TELEGRAM_CHAT_ID: "-1002780259470"

      # Admin privát chat ID – a kézi /summary-t csak innen fogadjuk
      TELEGRAM_ADMIN_CHAT_ID: "1326707238"

      RAPIDAPI_KEY: ${{ secrets.RAPIDAPI_KEY }}
      RAPIDAPI_HOST: "api-football-v1.p.rapidapi.com"
      TIMEZONE: "Europe/Budapest"

      # /summary frissesség-ablak (mp) – ha itt is futna kézi hívás
      SUMMARY_CMD_WINDOW_SEC: "120"

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run daily_summary
        run: |
          python daily_summary.py
